# ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

## ğŸ“Š æœ€æ–°æ›´æ–°ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰

**æ›´æ–°æ—¶é—´**: 2025-10-25  
**æ›´æ–°å†…å®¹**:
- âœ… æ·»åŠ è™šæ‹Ÿç¯å¢ƒ (venv)
- âœ… è°ƒæ•´ ConversationSession wrapper å‚æ•°ï¼ˆtimeout=60s, tts_wait_timeout=60sï¼‰
- âœ… æ·»åŠ å·¥å…·è°ƒç”¨ç­‰å¾…éŸ³æ•ˆï¼ˆsounds/tool_thinking.wavï¼‰
- âœ… åˆ‡æ¢åˆ° JSON æ ¼å¼çš„ System Promptï¼ˆæ›´é€‚åˆå¤§æ¨¡å‹ç†è§£ï¼‰

---

## ğŸ—‚ï¸ å®Œæ•´ç›®å½•ç»“æ„

```
agent_mvp/
â”‚
â”œâ”€â”€ ğŸ“¦ æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºå…¥å£ â­
â”‚   â”œâ”€â”€ agent_hybrid.py                  # æ··åˆæ¶æ„ Agentï¼ˆOpenAI + LangChainï¼‰
â”‚   â”œâ”€â”€ conversation_session.py          # å¯¹è¯ä¼šè¯ç®¡ç†å™¨ï¼ˆWrapperï¼‰
â”‚   â”œâ”€â”€ tools.py                         # LangChain å·¥å…·å®šä¹‰ï¼ˆ17ä¸ªå·¥å…·ï¼‰
â”‚   â”œâ”€â”€ config.py                        # é…ç½®ç®¡ç†ï¼ˆOpenAI/Ollama åˆ‡æ¢ï¼‰
â”‚   â”œâ”€â”€ logger_config.py                 # æ—¥å¿—é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ—£ï¸ TTS ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ tts_interface.py            # TTS é€šç”¨æ¥å£ï¼ˆEdge/OpenAI/Azureï¼‰
â”‚   â”‚   â”œâ”€â”€ streaming_tts_pipeline.py   # æµå¼ TTS ç®¡é“
â”‚   â”‚   â”œâ”€â”€ tts_optimizer.py            # TTS æ–‡æœ¬ä¼˜åŒ–å™¨ï¼ˆæ‰¹é‡æ¨¡å¼ï¼‰
â”‚   â”‚   â””â”€â”€ voice_feedback.py           # è¯­éŸ³ç­‰å¾…åé¦ˆï¼ˆéŸ³æ•ˆæ’­æ”¾ï¼‰â­
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ Prompt é…ç½®
â”‚       â”œâ”€â”€ prompts/
â”‚       â”‚   â”œâ”€â”€ system_prompt.json      # JSON æ ¼å¼ Promptï¼ˆæ¨èï¼‰â­
â”‚       â”‚   â””â”€â”€ README.md               # Prompt é…ç½®è¯´æ˜
â”‚
â”œâ”€â”€ ğŸµ èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ sounds/
â”‚   â”‚   â””â”€â”€ tool_thinking.wav           # å·¥å…·è°ƒç”¨éŸ³æ•ˆï¼ˆ23ç§’ï¼‰â­
â”‚   â”‚
â”‚   â””â”€â”€ test/outputs/
â”‚       â”œâ”€â”€ openai_tts_alloy_sample.mp3
â”‚       â”œâ”€â”€ openai_tts_echo_sample.mp3
â”‚       â”œâ”€â”€ openai_tts_fable_sample.mp3
â”‚       â”œâ”€â”€ openai_tts_nova_sample.mp3
â”‚       â”œâ”€â”€ openai_tts_onyx_sample.mp3
â”‚       â”œâ”€â”€ openai_tts_shimmer_sample.mp3 â­ (å½“å‰ä½¿ç”¨)
â”‚       â””â”€â”€ test_edge_tts.mp3
â”‚
â”œâ”€â”€ ğŸ§ª æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â”œâ”€â”€ test_session.py             # ä¼šè¯ç®¡ç†æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_bug_fixes.py           # Bug ä¿®å¤æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_sound_effect.py        # éŸ³æ•ˆæµ‹è¯• â­
â”‚   â”‚   â”œâ”€â”€ test_json_prompt.py         # JSON Prompt æµ‹è¯• â­
â”‚   â”‚   â”œâ”€â”€ test_ollama.py              # Ollama é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_multilingual_voice.py  # å¤šè¯­è¨€è¯­éŸ³æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_openai_tts.py          # OpenAI TTS æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_prompt_loading.py      # Prompt åŠ è½½æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_streaming_pipeline.py  # æµå¼ç®¡é“æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_tts_timestamps.py      # TTS æ—¶é—´æˆ³æµ‹è¯•
â”‚   â”‚   â””â”€â”€ ...ï¼ˆæ›´å¤šæµ‹è¯•æ–‡ä»¶ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ test_json_prompt.py             # JSON Prompt æµ‹è¯•ï¼ˆå¾…ç§»åŠ¨ï¼‰
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£
â”‚   â”œâ”€â”€ docs/
â”‚   â”‚   â”œâ”€â”€ README.md                   # æ–‡æ¡£ç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ ConversationSession_API.md  # Session API æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ Ollamaä½¿ç”¨æŒ‡å—.md           # Ollama é…ç½®æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜.md             # é¡¹ç›®ç»“æ„è¯´æ˜ï¼ˆæ—§ç‰ˆï¼‰
â”‚   â”‚   â”œâ”€â”€ é¡¹ç›®ç›®å½•ç»“æ„.md             # é¡¹ç›®ç›®å½•ç»“æ„ï¼ˆæ–°ç‰ˆï¼‰â­
â”‚   â”‚   â”œâ”€â”€ Wrapperæ›´æ–°ä¸Bugä¿®å¤æ€»ç»“.md # Bug ä¿®å¤è®°å½•
â”‚   â”‚   â”œâ”€â”€ v1.1.0_æ›´æ–°æ€»ç»“.md          # ç‰ˆæœ¬æ›´æ–°è®°å½•
â”‚   â”‚   â””â”€â”€ ...ï¼ˆæ›´å¤šæ–‡æ¡£ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ README.md                        # é¡¹ç›®ä¸»æ–‡æ¡£ â­
â”‚   â””â”€â”€ CHANGELOG.md                     # å˜æ›´æ—¥å¿—
â”‚
â”œâ”€â”€ ğŸ­ ç¤ºä¾‹ä»£ç 
â”‚   â””â”€â”€ examples/
â”‚       â”œâ”€â”€ demo_reception.py           # å‰å°æ¥å¾… Demo
â”‚       â””â”€â”€ demo_tts_showcase.py        # TTS å±•ç¤º Demo
â”‚
â”œâ”€â”€ ğŸ—‘ï¸ åºŸå¼ƒæ–‡ä»¶
â”‚   â””â”€â”€ waste/
â”‚       â”œâ”€â”€ agent.py                    # æ—§ç‰ˆ Agent
â”‚       â”œâ”€â”€ old_demos/                  # æ—§ç‰ˆç¤ºä¾‹
â”‚       â”œâ”€â”€ old_docs/                   # æ—§ç‰ˆæ–‡æ¡£
â”‚       â””â”€â”€ old_tests/                  # æ—§ç‰ˆæµ‹è¯•
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ .env                            # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
â”‚   â”œâ”€â”€ .env.example                    # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”œâ”€â”€ .gitignore                      # Git å¿½ç•¥è§„åˆ™
â”‚   â”œâ”€â”€ requirements.txt                # Python ä¾èµ–
â”‚   â””â”€â”€ start.sh                        # å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ è™šæ‹Ÿç¯å¢ƒ
â”‚   â””â”€â”€ venv/                           # Python è™šæ‹Ÿç¯å¢ƒ â­
â”‚       â”œâ”€â”€ bin/
â”‚       â”œâ”€â”€ lib/
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ ğŸ’¾ è¿è¡Œæ—¶æ•°æ®
    â”œâ”€â”€ sessions/                       # ä¼šè¯æŒä¹…åŒ–æ•°æ®ï¼ˆ.gitignoreï¼‰
    â”œâ”€â”€ logs/                           # æ—¥å¿—æ–‡ä»¶ï¼ˆ.gitignoreï¼‰
    â””â”€â”€ __pycache__/                    # Python ç¼“å­˜ï¼ˆ.gitignoreï¼‰
```

---

## ğŸ“ˆ ç»Ÿè®¡æ•°æ®

| ç±»åˆ« | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| **æ ¸å¿ƒæ¨¡å—** | 12 ä¸ª | åŒ…æ‹¬ Agentã€TTSã€Session ç­‰ |
| **å·¥å…·å‡½æ•°** | 17 ä¸ª | tools.py ä¸­å®šä¹‰ |
| **æµ‹è¯•æ–‡ä»¶** | 15+ ä¸ª | è¦†ç›–æ ¸å¿ƒåŠŸèƒ½ |
| **æ–‡æ¡£æ–‡ä»¶** | 15+ ä¸ª | è¯¦ç»†çš„ä½¿ç”¨å’Œå¼€å‘æ–‡æ¡£ |
| **éŸ³æ•ˆæ–‡ä»¶** | 1 ä¸ª | å·¥å…·è°ƒç”¨ç­‰å¾…éŸ³æ•ˆ |
| **ç¤ºä¾‹ä»£ç ** | 2 ä¸ª | å‰å°æ¥å¾…ã€TTS å±•ç¤º |

---

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### 1ï¸âƒ£ **ä¸»ç¨‹åº**
- `main.py`: ä¸»å…¥å£ï¼Œä½¿ç”¨ ConversationSession wrapper
- `start.sh`: å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆæ¿€æ´» venv + è¿è¡Œ main.pyï¼‰

### 2ï¸âƒ£ **Agent æ ¸å¿ƒ**
- `agent_hybrid.py`: æ··åˆæ¶æ„ï¼ˆOpenAI API + LangChain å·¥å…·ï¼‰
- `conversation_session.py`: ä¼šè¯ç®¡ç†å™¨ï¼ˆç”Ÿå‘½å‘¨æœŸã€è¶…æ—¶ã€æŒä¹…åŒ–ï¼‰
- `tools.py`: 17 ä¸ª LangChain å·¥å…·

### 3ï¸âƒ£ **TTS ç³»ç»Ÿ**
- `tts_interface.py`: ç»Ÿä¸€ TTS æ¥å£
- `streaming_tts_pipeline.py`: æµå¼ TTS å¤„ç†ç®¡é“
- `voice_feedback.py`: ç­‰å¾…éŸ³æ•ˆæ’­æ”¾å™¨ â­

### 4ï¸âƒ£ **é…ç½®ä¸æ—¥å¿—**
- `config.py`: OpenAI/Ollama é…ç½®åˆ‡æ¢
- `logger_config.py`: æ—¥å¿—ç³»ç»Ÿ
- `prompts/system_prompt.json`: JSON æ ¼å¼çš„ System Prompt â­

---

## ğŸ”§ æœ€æ–°æ”¹è¿›

### âœ… 1. è™šæ‹Ÿç¯å¢ƒ (venv)
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.12 -m venv venv

# æ¿€æ´»
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### âœ… 2. Session Wrapper å‚æ•°ä¼˜åŒ–
```python
# conversation_session.py
with ConversationSession(
    tts_provider="openai",
    tts_voice="shimmer",
    timeout=60,           # å•è½®å¯¹è¯è¶…æ—¶ 60s â­
    tts_wait_timeout=60   # TTS æ’­æ”¾ç­‰å¾… 60s â­
) as session:
    result = session.chat(user_input)
```

### âœ… 3. å·¥å…·è°ƒç”¨éŸ³æ•ˆ
```python
# voice_feedback.py
feedback = VoiceWaitingFeedback(mode='audio')

# å·¥å…·è°ƒç”¨æ—¶æ’­æ”¾
feedback.start('tool_thinking')  # æ’­æ”¾ sounds/tool_thinking.wav
# ... æ‰§è¡Œå·¥å…· ...
feedback.stop()  # åœæ­¢éŸ³æ•ˆ
```

### âœ… 4. JSON Promptï¼ˆæ›´é€‚åˆå¤§æ¨¡å‹ï¼‰
```json
{
  "identity": {
    "name": "èŒ¶èŒ¶",
    "role": "AIè¯­éŸ³åŠ©æ‰‹"
  },
  "voice_interaction_rules": {
    "response_length": { "max_chars": 100 },
    "forbidden_outputs": { ... }
  },
  "available_tools": [ ... ],
  "mandatory_rules": { ... }
}
```

ä¼˜åŠ¿ï¼š
- âœ… ç»“æ„åŒ–æ›´æ¸…æ™°
- âœ… ä¾¿äºå¤§æ¨¡å‹ç†è§£
- âœ… æ”¯æŒåµŒå¥—å’Œæ‰©å±•
- âœ… å¯ç¨‹åºåŒ–ä¿®æ”¹

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å¯åŠ¨
./start.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
source venv/bin/activate
python main.py
```

---

## ğŸ“ å¾…åŠäº‹é¡¹

- [ ] ç§»åŠ¨æ ¹ç›®å½•çš„æµ‹è¯•æ–‡ä»¶åˆ° test/ ç›®å½•
- [ ] è¡¥å……æ›´å¤šéŸ³æ•ˆæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
- [ ] ä¼˜åŒ– JSON Prompt åŠ è½½æ€§èƒ½
- [ ] æ·»åŠ æ›´å¤šè¯­è¨€çš„ System Prompt ç¤ºä¾‹

---

**ç»´æŠ¤è€…**: AI Agent MVP Team  
**æœ€åæ›´æ–°**: 2025-10-25

