# 🎯 项目结构说明

## 📂 核心文件

### 系统核心

```
agent_hybrid.py          ⭐ 混合架构Agent（核心引擎）
tools.py                 17个工具（11个基础 + 6个前台接待）
tts_optimizer.py         TTS优化系统（文本优化 + 音频管理）
voice_feedback.py        语音等待反馈
config.py                配置文件
```

### 主程序（3 个）

```
demo_hybrid.py           ⭐ 通用主程序（日常使用）
demo_reception.py        🏢 前台接待演示
demo_tts_showcase.py     🎵 TTS功能演示
```

### 测试程序

```
test_hybrid_vs_langchain.py   性能对比测试
```

### 文档

```
README.md                      项目说明
混合架构优化报告.md            完整技术报告
前台接待Agent说明.md           应用场景说明
requirements.txt               依赖清单
```

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置 API 密钥

编辑 `config.py`，设置你的 OpenAI API 密钥

### 3. 运行主程序

```bash
# 通用主程序（推荐）
python demo_hybrid.py

# 前台接待演示
python demo_reception.py

# TTS功能演示
python demo_tts_showcase.py
```

---

## 🛠️ 工具列表

### 基础工具（11 个）

1. **calculator** - 数学计算
2. **time_tool** - 时间查询
3. **text_analyzer** - 文本分析
4. **unit_converter** - 单位转换
5. **data_comparison** - 数据比较
6. **logic_reasoning** - 逻辑推理
7. **library_system** - 图书馆管理
8. **end_conversation_detector** - 对话结束检测
9. **web_search** - 网络搜索
10. **file_operation** - 文件操作
11. **set_reminder** - 提醒设置

### 前台接待工具（6 个）

12. **visitor_registration** - 访客登记
13. **meeting_room_system** - 会议室管理
14. **employee_directory** - 员工通讯录
15. **direction_guide** - 路线指引
16. **package_management** - 快递管理
17. **faq_system** - 常见问题解答

---

## 🎵 TTS 优化系统

### 文本优化

- ✅ 清理 markdown/代码块/链接
- ✅ 智能分句（语义完整）
- ✅ 缩写展开（AI→ 人工智能）
- ✅ 长句拆分（最大 100 字符）

### 音频播放管理

- ✅ 防止重叠播放（互斥锁）
- ✅ 处理乱序/失败（重试机制）
- ✅ 并发生成 + 顺序播放
- ✅ 精确停顿控制

---

## 📊 性能特点

| 特性                  | 纯 LangChain | 混合架构       | 提升     |
| --------------------- | ------------ | -------------- | -------- |
| 工具调用可靠性        | 0-20%        | 100%           | +80-100% |
| 多轮对话速度          | 基准         | KV Cache 优化  | 1.5-3x   |
| end_conversation 检测 | 0%           | 100%           | +100%    |
| 成本节约              | 基准         | Prompt Caching | 40-50%   |

---

## 🗂️ 归档目录

`waste/` 目录存放旧版本文件：

- `old_demos/` - 旧演示程序
- `old_tests/` - 旧测试程序
- `old_docs/` - 旧文档
- `agent.py` - 旧版 Agent（保留作对比）

---

## 📝 开发指南

### 添加新工具

1. 在 `tools.py` 中定义工具类
2. 在 `agent_hybrid.py` 的 `_init_langchain_tools()` 中添加
3. 工具会自动转换为 OpenAI 格式

### 接入真实 TTS 引擎

在 `tts_optimizer.py` 的 `TTSAudioManager` 中：

- 实现 `_blocking_play()` 方法
- 设置 TTS 引擎函数

示例：

```python
agent = HybridReasoningAgent(
    enable_tts=True,
    tts_engine=your_tts_function  # text -> audio_bytes
)
```

---

## 🎯 推荐使用流程

1. **日常使用**: `python demo_hybrid.py`
2. **查看文档**: 阅读 `混合架构优化报告.md`
3. **性能测试**: `python test_hybrid_vs_langchain.py`
4. **前台演示**: `python demo_reception.py`
5. **TTS 测试**: `python demo_tts_showcase.py`
